<mat-toolbar class="view-header mat-elevation-z1">
  <span class="title">{{documentType?.folder | uppercase}}</span>
  <!-- This fills the remaining space of the current row -->
  <span class="app-toolbar-filler"></span>
  <button (click)="add_new()" mat-button>NEO ΠΑΡΑΣΤΑΤΙΚΟ</button>
  <label class="divider" *ngIf="!starthere">|</label>
  <button *ngIf="!starthere" (click)="toggleInfoPanel()" mat-icon-button>
    <mat-icon>info_outline</mat-icon>
  </button>
  <span class="app-toolbar-right-filler"></span>
</mat-toolbar>

<div class="view-content">
  <div fxLayout="row" *ngIf="!starthere">
    <div fxFlex>
      <mat-toolbar>
        <mat-form-field floatPlaceholder='never'>
          <input mat-input [(ngModel)]="searchText" matInput type="text" placeholder="Αναζήτηση" maxlength="300">
        </mat-form-field>
        <button mat-icon-button (click)="dosearch()" [disabled]="!cansearch()">
          <mat-icon>search</mat-icon>
        </button>
        <button mat-icon-button (click)="clear()" *ngIf="canclear()">
          <mat-icon>close</mat-icon>
        </button>
        <label class="search-status">{{status}}</label>
        <span class="app-toolbar-filler"></span>
        <!-- put pager here -->
        <mat-paginator [length]="count" *ngIf="showPager" [pageIndex]="pageindex" [pageSize]="pagesize" [pageSizeOptions]="[5, 10, 25, 50, 100]"
          (page)="pagerEvent($event)">
        </mat-paginator>
        <span class="app-toolbar-right-filler"></span>
      </mat-toolbar>

      <!-- *ngIf="viewoptions.value=='grid'" -->
      <div fxLayout="row" fxLayout.lt-md="column" fxLayoutWrap fxLayoutAlign="start start">
        <mat-card class="doc-card" *ngFor="let doc of documents;let i = index;">
          <div class="selected-item" *ngIf="selected && doc.id===selected.id" fxFlexAlign="end"></div>
          <div class="status-chip" [ngClass]="doc.model.status">
            <label class="status-label">{{doc.model.status | uppercase}}</label>
          </div>
          <!-- <mat-icon class="selected-icon" *ngIf="selected && doc.id===selected.id">check_circle</mat-icon> -->
          <mat-card-header (click)="setSelected(doc)" class="clickable-header">
            <mat-card-title>
              <label class="small">{{doc.documentType.name}}</label>
              <h2 *ngIf="doc.model.numberPrintable">{{doc.model.numberPrintable}}</h2>
              <h2 *ngIf="!doc.model.numberPrintable">{{doc.model.status}}</h2>
            </mat-card-title>
            <mat-divider></mat-divider>
            <mat-card-title>ΣΥΝΟΛΟ: {{doc.model.total | currency:doc.model.currencyCode}}</mat-card-title>
            <mat-card-subtitle>ΠΛΗΡΩΤΕΟ: {{doc.model.totalPayable | currency:doc.model.currencyCode}}</mat-card-subtitle>
            <mat-card-subtitle>{{doc.model.date | date:'shortDate'}}</mat-card-subtitle>
            <mat-card-title>{{doc.model?.recipient?.organisation?.name}}</mat-card-title>
            <mat-card-subtitle>{{doc.model?.recipient?.contact?.displayName}}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>

          </mat-card-content>
        </mat-card>
      </div>

      <mat-toolbar *ngIf="!norecords && showPager && showPagerBottom">
        <span class="app-toolbar-filler"></span>
        <!-- put pager here -->
        <mat-paginator [length]="count" [pageIndex]="pageindex" [pageSize]="pagesize" [pageSizeOptions]="[5, 10, 25, 50, 100]" (page)="pagerEvent($event)">
        </mat-paginator>
        <span class="app-toolbar-right-filler"></span>
      </mat-toolbar>
    </div>
    <div fxFlex="360px" fxLayoutAlign="start stretch" fxShow fxHide.lt-md class="doc-info-panel" *ngIf="showInfo">
      <div class="no-records" fxFlex fxLayout="column" fxLayoutAlign="center center" *ngIf="!selected">
        <label class="small">δεν έχετε επιλέξει καποιο έγγραφο.</label>
        <img src="assets/images/no-records.png" class="no-records">
        <button color="primary" (click)="add_new()" mat-button>
          <label class="small">ΝΕΟ ΠΑΡΑΣΤΑΤΙΚΟ!</label>
        </button>
      </div>
      <div *ngIf="selected">
        <label class="small">{{selected.documentType.name}}</label>
        <button class="menu-status" mat-button [ngClass]="selected.model.status" [matMenuTriggerFor]="menu">
          <label class="status">{{selected.model.status | uppercase}}</label>
          <mat-icon>keyboard_arrow_down</mat-icon>
        </button>
        <mat-menu #menu="matMenu" class="status-actions" [overlapTrigger]="false">
          <a mat-menu-item>
            <mat-icon>library_books</mat-icon>Προβολή</a>
          <button mat-menu-item>
            <mat-icon>edit</mat-icon>Μεταβολή</button>
          <button mat-menu-item>
            <mat-icon>content_copy</mat-icon>Αντίγραφο</button>
          <mat-divider></mat-divider>
          <button mat-menu-item>
            <mat-icon>payment</mat-icon>Πληρωμή</button>
          <mat-divider></mat-divider>
          <button mat-menu-item>
            <mat-icon>close</mat-icon>Ακύρωση</button>
          <button mat-menu-item>
            <mat-icon>delete_forever</mat-icon>Διαγραφή</button>
        </mat-menu>

        <h1 *ngIf="selected.model.numberPrintable">{{selected.model.numberPrintable}}</h1>
        <h2 *ngIf="!selected.model.numberPrintable">{{selected.model.status}} {{selected.model.date | date:'longDate'}}</h2>
        <h3 *ngIf="selected.model.numberPrintable">{{selected.model.date | date:'shortDate'}}</h3>
        <!-- <iframe class="preview-doc" ></iframe> -->
        <a class="portal-link" [href]="selected.portalLink" target="__new" mat-button>
          <div class="wrap">
            <iframe class="frame" [attr.src]="selected.safePortalLink">
            </iframe>
          </div>
        </a>
        <div>
          <a mat-icon-button disabled="true" class="download-link">
            <mat-icon>share</mat-icon>
          </a>
          <a [download]='selected.model.id+".pdf"' [href]="selected.portalPdfLink" mat-icon-button>
            <img class="small" src="assets/images/pdf.svg">
          </a>
          <a [download]='selected.model.id+".docx"' [href]="selected.portalDocLink" mat-icon-button>
            <img class="small" src="assets/images/word.svg">
          </a>
        </div>
        <!-- <label class="small">ΣΕΛΙΔΑ ΠΕΛΑΤΗ</label> -->
        <label class="small" *ngIf="selected.model.recipient.organisation || selected.model.recipient.contact">ΠΕΛΑΤΗΣ</label>
        <h2 *ngIf="selected.model.recipient.organisation">{{selected.model.recipient.organisation.name}}</h2>
        <label *ngIf="selected.model.recipient.organisation">{{selected.model.recipient.organisation.legalName}}</label>
        <h2 *ngIf="selected.model.recipient.contact">{{selected.model.recipient.contact.firstName}} {{selected.model.recipient.contact.lastName}}</h2>
        <label class="small">ΣΥΝΟΛΟ</label>
        <h2>{{selected.model.total | currency:selected.model.currencyCode}}</h2>
        <label class="small">ΠΛΗΡΩΤΕΟ</label>
        <h3>{{selected.model.totalPayable | currency:selected.model.currencyCode}}</h3>

      </div>
    </div>
  </div>

  <div class="no-records" fxLayout="column" fxLayoutAlign="center center" *ngIf="starthere">
    <label class="small">δεν βρέθηκαν έγγραφα.</label>
    <img src="assets/images/no-records.png" class="no-records">
    <button color="primary" (click)="add_new()" mat-button>
      <label class="small">ΞΕΚΙΝΗΣΤΕ ΕΔΩ!</label>
    </button>
  </div>
</div>
